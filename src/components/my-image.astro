---
import { Image as UnpicImage } from '@unpic/astro'
import type { ImageMetadata } from 'astro'

export interface Props {
	src: string | ImageMetadata
	alt: string
	width: number
	height: number
	loading?: 'lazy' | 'eager'
	priority?: boolean
	class?: string
	role?: any
	fetchpriority?: 'high' | 'low' | undefined
	aspectRatio?: number
	layout?: 'fixed' | 'constrained' | 'fullWidth'
	placeholder?: 'blur' | 'none'
	background?: string
	breakpoints?: number[]
	sizes?: string
}

const {
	src,
	alt,
	width,
	height,
	loading = 'lazy',
	class: className,
	role,
	fetchpriority,
	aspectRatio,
	layout = 'constrained',
	placeholder,
	background,
	breakpoints,
	priority,
	sizes,
	...rest
} = Astro.props

// Handle Astro image imports (ImageMetadata) and string URLs
const imageSrc = typeof src === 'string' ? src : src.src
---

<!--
    This is a wrapper component for @unpic/astro Image.
    To replace the image library, just modify the implementation below.
    The component interface will remain the same.
-->
<UnpicImage
	src={imageSrc}
	alt={alt}
	width={width}
	height={height}
	loading={loading}
	class={className}
	role={role}
	fetchpriority={fetchpriority}
	aspectRatio={aspectRatio}
	layout={layout}
	placeholder={placeholder}
	background={background}
	breakpoints={breakpoints}
	sizes={sizes}
	priority={priority}
	{...rest}
/>
